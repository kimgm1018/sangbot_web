<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>ìƒë´‡.COM</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<div class="app">
		<aside class="sidebar" role="navigation" aria-label="ìƒë´‡.COM ì‚¬ì´ë“œë°”">
			<div class="brand">ìƒë´‡<span class="dot">.COM</span></div>
			<nav class="nav">
				<button class="nav-item active" data-target="#ck">ğŸ® ë¡¤ CK</button>
				<button class="nav-item" data-target="#lottery">ğŸ² ë³µë¶ˆë³µ</button>
				<button class="nav-item" data-target="#wheel">ğŸ§­ ì›íŒ ëŒë¦¬ê¸°</button>
				<button class="nav-item" data-target="#ladder">ğŸªœ ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</button>
			</nav>
			<div class="note">
				<p>í•˜ëŠ˜ìƒ‰ í…Œë§ˆ Â· ê¹”ë”í•œ ìœ í‹¸ ëª¨ìŒ</p>
			</div>
		</aside>

		<main class="content">
			<header class="page-header">
				<h1>ìƒë´‡.COM</h1>
				<p>ë””ìŠ¤ì½”ë“œ ìƒë´‡ ê¸°ëŠ¥ì„ ì›¹ì—ì„œ ê°„í¸í•˜ê²Œ</p>
			</header>

			<section id="ck" class="panel visible" aria-labelledby="ck-title">
				<h2 id="ck-title">ë¡¤ CK íŒ€ êµ¬ì„±</h2>
				<p class="help">ê° ë¼ì¸ì— ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”. ê³ ì •í•˜ë ¤ë©´ ì²´í¬ë¥¼ í™œì„±í™”í•˜ì„¸ìš”.</p>
				<div class="ck-grid">
					<div class="team-col">
						<h3 class="team-title red">Red íŒ€</h3>
						<div class="pos">
							<label>TOP</label>
							<input type="text" id="red-0" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="red-fix-0"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>JUNGLE</label>
							<input type="text" id="red-1" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="red-fix-1"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>MID</label>
							<input type="text" id="red-2" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="red-fix-2"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>AD</label>
							<input type="text" id="red-3" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="red-fix-3"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>SUPPORT</label>
							<input type="text" id="red-4" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="red-fix-4"> ê³ ì •</label>
						</div>
					</div>

					<div class="team-col">
						<h3 class="team-title blue">Blue íŒ€</h3>
						<div class="pos">
							<label>TOP</label>
							<input type="text" id="blue-0" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="blue-fix-0"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>JUNGLE</label>
							<input type="text" id="blue-1" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="blue-fix-1"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>MID</label>
							<input type="text" id="blue-2" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="blue-fix-2"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>AD</label>
							<input type="text" id="blue-3" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="blue-fix-3"> ê³ ì •</label>
						</div>
						<div class="pos">
							<label>SUPPORT</label>
							<input type="text" id="blue-4" placeholder="ë‹‰ë„¤ì„">
							<label class="fix"><input type="checkbox" id="blue-fix-4"> ê³ ì •</label>
						</div>
					</div>
				</div>

				<div class="actions">
					<button id="ck-run" class="btn primary">íŒ€ êµ¬ì„±í•˜ê¸°</button>
					<button id="ck-reset" class="btn">ì´ˆê¸°í™”</button>
				</div>

				<pre class="result" id="ck-result" aria-live="polite"></pre>
			</section>

			<section id="lottery" class="panel" aria-labelledby="lottery-title">
				<h2 id="lottery-title">ë³µë¶ˆë³µ ì¶”ì²¨</h2>
				<div class="lottery-form">
					<div class="field">
						<label for="lottery-names">ëª…ë‹¨ (ë„ì–´ì“°ê¸° ë˜ëŠ” ì¤„ë°”ê¿ˆ)</label>
						<textarea id="lottery-names" rows="4" placeholder="ì˜ˆ) ìƒë³´ ì‚°í•˜ ìƒì¸ ê°•ë¯¼ ..."></textarea>
					</div>
					<div class="row">
						<div class="field sm">
							<label for="lottery-k">ì¶”ì²¨ ì¸ì› ìˆ˜</label>
							<input type="number" id="lottery-k" min="1" value="1">
						</div>
						<div class="field sm">
							<label>ì¶”ì²¨ ë°©ë²•</label>
							<div class="radios">
								<label><input type="radio" name="how" value="dup" checked> ì¤‘ë³µ í—ˆìš©</label>
								<label><input type="radio" name="how" value="nodup"> ì¤‘ë³µ ë¹„í—ˆìš©</label>
							</div>
						</div>
					</div>

					<div class="actions">
						<button id="lottery-run" class="btn primary">ì¶”ì²¨í•˜ê¸°</button>
						<button id="lottery-reroll" class="btn" disabled>ë‹¤ì‹œ ë½‘ê¸°</button>
					</div>

					<pre class="result" id="lottery-result" aria-live="polite"></pre>
				</div>
			</section>

			<section id="wheel" class="panel" aria-labelledby="wheel-title">
				<h2 id="wheel-title">ì›íŒ ëŒë¦¬ê¸°</h2>
				<p class="help">ì¸ì› ìˆ˜ë¥¼ ì •í•˜ê³  ì´ë¦„ì„ ì…ë ¥í•œ ë‹¤ìŒ ì›íŒì„ ëŒë¦¬ì„¸ìš”.</p>
				<div class="wheel-wrap">
					<div class="wheel-side">
						<canvas id="wheel-canvas" width="380" height="380" aria-label="ì¶”ì²¨ ì›íŒ" role="img"></canvas>
						<canvas id="wheel-confetti" width="380" height="380" aria-hidden="true"></canvas>
						<div class="wheel-pointer" aria-hidden="true">â–¼</div>
					</div>
					<div class="wheel-form">
						<div class="field sm">
							<label for="wheel-count">ì¸ì› ìˆ˜</label>
						<input type="number" id="wheel-count" min="2" max="15" value="2">
						</div>
						<div id="wheel-segments" class="segments-grid" aria-live="polite"></div>
						<div class="actions">
							<button id="wheel-spin" class="btn primary">ëŒë¦¬ê¸°</button>
							<button id="wheel-reset" class="btn">ì´ˆê¸°í™”</button>
						</div>
						<pre class="result" id="wheel-result" aria-live="polite"></pre>
					</div>
				</div>
			</section>

			<section id="ladder" class="panel" aria-labelledby="ladder-title">
				<h2 id="ladder-title">ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</h2>
				<p class="help">ì¸ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ê³  ì´ë¦„ê³¼ í•˜ë‹¨ ê²°ê³¼ë¥¼ ì±„ìš´ ë’¤ ì‚¬ë‹¤ë¦¬ë¥¼ íƒ€ì„¸ìš”.</p>
				<div class="ladder-wrap">
					<div class="ladder-form">
						<div class="field sm">
							<label for="ladder-count">ì¸ì› ìˆ˜</label>
					<input type="number" id="ladder-count" min="2" max="15" value="2">
						</div>
						<div id="ladder-names" class="segments-grid" aria-label="ì´ë¦„ ì…ë ¥ì¹¸"></div>
						<div id="ladder-foots" class="segments-grid" aria-label="í•˜ë‹¨ ê²°ê³¼ ì…ë ¥ì¹¸"></div>
						<div class="actions">
							<button id="ladder-run" class="btn primary">ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</button>
							<div id="ladder-person-buttons" class="person-buttons"></div>
							<button id="ladder-reset" class="btn">ì´ˆê¸°í™”</button>
						</div>
					</div>
					<div class="ladder-side">
						<canvas id="ladder-canvas" width="560" height="420" aria-label="ì‚¬ë‹¤ë¦¬" role="img"></canvas>
					</div>
				</div>
				<pre class="result" id="ladder-result" aria-live="polite"></pre>
			</section>
		</main>
	</div>

	<script>
		// ë„¤ë¹„ê²Œì´ì…˜ ì „í™˜
		document.querySelectorAll('.nav-item').forEach(btn => {
			btn.addEventListener('click', () => {
				document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
				document.querySelectorAll('.panel').forEach(p => p.classList.remove('visible'));
				btn.classList.add('active');
				const target = document.querySelector(btn.dataset.target);
				if (target) target.classList.add('visible');
			});
		});

		// ìœ í‹¸
		function shuffle(array) {
			for (let i = array.length - 1; i > 0; i--) {
				const j = Math.floor(Math.random() * (i + 1));
				[array[i], array[j]] = [array[j], array[i]];
			}

			// ê³µìš©: í…ìŠ¤íŠ¸ì˜ì—­ ë‚´ìš©ì„ ì›íŒ ì…ë ¥ìœ¼ë¡œ ë³µì‚¬
			document.getElementById('lottery-names')?.addEventListener('input', (e) => {
				const val = (e.target.value||'');
				const wheelInput = document.getElementById('wheel-names');
				if (wheelInput && !wheelInput.value) {
					wheelInput.value = val;
				}
			});
			return array;
		}

		// ë¡¤ CK ë¡œì§ (Discord ë´‡ ë¡œì§ì„ ì›¹ìœ¼ë¡œ ì´ì‹)
		document.getElementById('ck-run').addEventListener('click', () => {
			const positions = ["TOP","JUNGLE","MID","AD","SUPPORT"];
			const redFixed = new Array(5).fill(null);
			const blueFixed = new Array(5).fill(null);
			const redPool = [];
			const bluePool = [];

			for (let i = 0; i < 5; i++) {
				const rName = (document.getElementById(`red-${i}`).value || '').trim();
				const rFix = document.getElementById(`red-fix-${i}`).checked;
				const bName = (document.getElementById(`blue-${i}`).value || '').trim();
				const bFix = document.getElementById(`blue-fix-${i}`).checked;

				if (!rName || !bName) {
					alert('ê° íŒ€ì˜ ëª¨ë“  ë¼ì¸ì— ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì´ 10ëª…)');
					return;
				}

				if (rFix) redFixed[i] = rName; else redPool.push(rName);
				if (bFix) blueFixed[i] = bName; else bluePool.push(bName);
			}

			shuffle(redPool);
			shuffle(bluePool);

			for (let i = 0; i < 5; i++) {
				if (redFixed[i] === null) redFixed[i] = redPool.pop();
				if (blueFixed[i] === null) blueFixed[i] = bluePool.pop();
			}

			let lines = [];
			for (let i = 0; i < 5; i++) {
				lines.push(`RedíŒ€ ${positions[i]} : ${redFixed[i]}  -  BlueíŒ€ ${positions[i]} : ${blueFixed[i]}`);
			}
			document.getElementById('ck-result').textContent = lines.join('\n');
		});

		document.getElementById('ck-reset').addEventListener('click', () => {
			for (let i = 0; i < 5; i++) {
				document.getElementById(`red-${i}`).value = '';
				document.getElementById(`blue-${i}`).value = '';
				document.getElementById(`red-fix-${i}`).checked = false;
				document.getElementById(`blue-fix-${i}`).checked = false;
			}
			document.getElementById('ck-result').textContent = '';
		});

			// ë³µë¶ˆë³µ ë¡œì§
		let lastLotteryState = null; // { names, k, allowDuplicate }

		function getLotteryResult(names, k, allowDuplicate) {
			if (allowDuplicate) {
				const selected = [];
				for (let i = 0; i < k; i++) selected.push(names[Math.floor(Math.random()*names.length)]);
				const counter = {};
				for (const n of selected) counter[n] = (counter[n]||0)+1;
				const sorted = Object.entries(counter).sort((a,b)=>b[1]-a[1]);
				const lines = sorted.map(([n,c])=>`${n} : ${c}íšŒ`);
				const topCount = sorted[0][1];
				const topNames = sorted.filter(([,c])=>c===topCount).map(([n])=>n);
				if (topNames.length === 1) lines.push(`\nğŸ‰ ë‹¹ì²¨: ${topNames[0]} (${topCount}íšŒ)`);
				else lines.push(`\nâš–ï¸ ë¬´ìŠ¹ë¶€: ${topNames.join(', ')} (${topCount}íšŒì”©)`);
				return lines.join('\n');
			} else {
				const pool = [...names];
				shuffle(pool);
				return pool.slice(0, k).join('\n');
			}
		}

		document.getElementById('lottery-run').addEventListener('click', () => {
			const raw = (document.getElementById('lottery-names').value || '').trim();
			const names = raw.split(/\s+/).filter(Boolean);
			const k = parseInt(document.getElementById('lottery-k').value, 10) || 0;
			const how = document.querySelector('input[name="how"]:checked').value;
			const allowDuplicate = (how === 'dup');

			if (!names.length || k < 1) {
				alert('ëª…ë‹¨ê³¼ ì¶”ì²¨ ì¸ì› ìˆ˜ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
				return;
			}
			if (!allowDuplicate && k > names.length) {
				alert('ì¶”ì²¨ ì¸ì›ì´ ëª…ë‹¨ë³´ë‹¤ ë§ìŠµë‹ˆë‹¤. (ì¤‘ë³µ ë¹„í—ˆìš©)');
				return;
			}

			lastLotteryState = { names, k, allowDuplicate };
			document.getElementById('lottery-reroll').disabled = false;
			document.getElementById('lottery-result').textContent = getLotteryResult(names, k, allowDuplicate);
		});

		document.getElementById('lottery-reroll').addEventListener('click', () => {
			if (!lastLotteryState) return;
			document.getElementById('lottery-result').textContent = getLotteryResult(lastLotteryState.names, lastLotteryState.k, lastLotteryState.allowDuplicate);
		});

			// ì›íŒ ëŒë¦¬ê¸° ë¡œì§
			(function initWheel(){
				const canvas = document.getElementById('wheel-canvas');
				if (!canvas) return; // ì„¹ì…˜ ë¹„í‘œì‹œì¼ ìˆ˜ ìˆìŒ
				const ctx = canvas.getContext('2d');
				const resultEl = document.getElementById('wheel-result');
				const spinBtn = document.getElementById('wheel-spin');
				const resetBtn = document.getElementById('wheel-reset');
				const countEl = document.getElementById('wheel-count');
				const segWrap = document.getElementById('wheel-segments');

				let segments = Array.from({length: Math.max(2, Math.min(15, parseInt(countEl.value,10)||2))}, (_, i) => `${i+1}ë²ˆ`);
				let colors = ['#ffcc80','#ffab91','#80deea','#c5e1a5','#f48fb1','#b39ddb','#ffe082','#a5d6a7'];
				let angle = 0; // í˜„ì¬ ë¼ë””ì•ˆ ê°ë„
				let spinning = false;
				let rafId = null;
				const DEFAULT_ROUNDS = 5; // ê³ ì • íšŒì „ìˆ˜
				const DEFAULT_DURATION = 3; // ê³ ì • ì§€ì†ì‹œê°„(ì´ˆ)

				function buildSegmentInputs(n){
					segWrap.innerHTML = '';
					for (let i=0;i<n;i++){
						const input = document.createElement('input');
						input.type = 'text';
						input.placeholder = `${i+1}ë²ˆ ì´ë¦„`;
						input.value = segments[i] || `${i+1}ë²ˆ`;
						input.dataset.index = String(i);
						segWrap.appendChild(input);
					}
				}

				function readSegmentsFromInputs(){
					const inputs = Array.from(segWrap.querySelectorAll('input'));
					const arr = inputs.map(el => (el.value||'').trim()).map((v, i) => v || `${i+1}ë²ˆ`);
					segments = arr;
				}

				function drawWheel(){
					const w = canvas.width, h = canvas.height;
					const cx = w/2, cy = h/2, r = Math.min(w,h)/2 - 6;
					ctx.clearRect(0,0,w,h);
					ctx.save();
					ctx.translate(cx, cy);
					ctx.rotate(angle);
					const n = segments.length;
					for (let i=0;i<n;i++){
						const start = i * (Math.PI*2/n);
						const end = (i+1) * (Math.PI*2/n);
						ctx.beginPath();
						ctx.moveTo(0,0);
						ctx.arc(0,0,r,start,end);
						ctx.closePath();
						ctx.fillStyle = colors[i % colors.length];
						ctx.fill();

						// í…ìŠ¤íŠ¸
						ctx.save();
						ctx.rotate(start + (end-start)/2);
						ctx.translate(r*0.68,0);
						ctx.rotate(Math.PI/2);
						ctx.fillStyle = '#0c2940';
						ctx.font = 'bold 14px "Noto Sans KR", Arial';
						ctx.textAlign = 'center';
						ctx.textBaseline = 'middle';
						const label = segments[i];
						ctx.fillText(label,0,0);
						ctx.restore();
					}
					ctx.restore();
				}

				function setInputsDisabled(disabled){
					Array.from(segWrap.querySelectorAll('input')).forEach(i => { i.disabled = disabled; });
					countEl.disabled = disabled;
				}

				function pickByAngle(){
					const n = segments.length;
					if (n < 2) return { index: -1, name: undefined };
					// í¬ì¸í„°ëŠ” 12ì‹œ ë°©í–¥(â–¼ê°€ ìœ„ì— ìˆê³  ì•„ë˜ë¥¼ ê°€ë¦¬í‚´): ê°ë„ -Ï€/2
					const sectorSize = (Math.PI*2)/n;
					const pointer = -Math.PI/2;
					const a = (pointer - (angle % (Math.PI*2)) + Math.PI*2) % (Math.PI*2);
					const safe = Math.min(a, (Math.PI*2) - 1e-10);
					const index = Math.floor(safe/sectorSize) % n;
					const name = (segments[index] && segments[index].trim()) ? segments[index] : `${index+1}ë²ˆ`;
					return { index, name };
				}

				function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

				function spin(){
					if (spinning) return;
					readSegmentsFromInputs();
					colors = colors.concat(colors).slice(0, Math.max(colors.length, segments.length));
					resultEl.textContent = '';
					let rounds = DEFAULT_ROUNDS;
					let duration = DEFAULT_DURATION; // ì´ˆ
					const startAngle = angle % (Math.PI*2);
					const namesSnapshot = segments.slice();
					const n = namesSnapshot.length;
					const targetIndex = Math.floor(Math.random()*n);
					const sector = (Math.PI*2)/n;
					// í¬ì¸í„°(12ì‹œ, â–¼ê°€ ìœ„ì—ì„œ íœ˜ë¥¼ ê°€ë¦¬í‚´)ê°€ targetIndex ì¤‘ì•™ì„ ê°€ë¦¬í‚¤ë„ë¡ ìµœì¢… angle ê³„ì‚°
					const pointer = -Math.PI/2;
					const desired = pointer - (targetIndex + 0.5) * sector; // ìµœì¢… angle
					const delta = ((desired - startAngle) % (Math.PI*2) + Math.PI*2) % (Math.PI*2);
					const totalRotation = rounds*(Math.PI*2) + delta;
					const start = performance.now();
					spinning = true;
					setInputsDisabled(true);

					function frame(now){
						const t = Math.min(1, (now - start)/(duration*1000));
						const eased = easeOutCubic(t);
						angle = startAngle + totalRotation * eased;
						drawWheel();
						if (t < 1){
							rafId = requestAnimationFrame(frame);
						} else {
							spinning = false;
							setInputsDisabled(false);
							const winner = (namesSnapshot[targetIndex] && namesSnapshot[targetIndex].trim()) ? namesSnapshot[targetIndex] : `${targetIndex+1}ë²ˆ`;
							resultEl.textContent = `ğŸ‰ ë‹¹ì²¨: ${winner}`;
							triggerConfetti();
						}
					}
					rafId = requestAnimationFrame(frame);
				}

				function reset(){
					if (spinning && rafId) cancelAnimationFrame(rafId);
					spinning = false;
					angle = 0;
					resultEl.textContent = '';
					drawWheel();
				}

				// ì´ˆê¸° ì„¸íŒ…
				buildSegmentInputs(parseInt(countEl.value,10)||2);
				drawWheel();
				countEl.addEventListener('change', () => {
					let n = Math.max(2, Math.min(15, parseInt(countEl.value,10)||2));
					// í˜„ì¬ segmentsë¥¼ ë³´ì¡´í•˜ë©´ì„œ ê¸¸ì´ ì¡°ì •
					if (n > segments.length) {
						segments = segments.concat(Array.from({length: n - segments.length}, (_, i) => `${segments.length + i + 1}ë²ˆ`));
					} else if (n < segments.length) {
						segments = segments.slice(0, n);
					}
					buildSegmentInputs(n);
					drawWheel();
				});
				spinBtn.addEventListener('click', spin);
				resetBtn.addEventListener('click', reset);
				// ì¡°ê° í´ë¦­ â†’ ì´ë¦„ í¸ì§‘
				canvas.addEventListener('click', (ev) => {
					if (spinning) return;
					const rect = canvas.getBoundingClientRect();
					const x = ev.clientX - rect.left;
					const y = ev.clientY - rect.top;
					const cx = canvas.width/2, cy = canvas.height/2;
					const dx = x - cx, dy = y - cy;
					const r = Math.min(canvas.width, canvas.height)/2 - 6;
					const dist = Math.hypot(dx, dy);
					if (dist < 20 || dist > r + 6) return; // ì¤‘ì‹¬ë¶€/ì™¸ê³½ í´ë¦­ ë¬´ì‹œ
					const raw = Math.atan2(dy, dx); // 3ì‹œ=0, CCW ì¦ê°€
					// ë“œë¡œì‰ ì‹œ angleë§Œí¼ íšŒì „í–ˆìœ¼ë¯€ë¡œ ë°˜ëŒ€ë¡œ ë³´ì •í•´ ë“œë¡œì‰ ì¢Œí‘œê³„ ê°ë„ë¡œ í™˜ì‚°
					const a = (raw - angle + Math.PI*2) % (Math.PI*2);
					const n = segments.length;
					if (n < 2) return;
					const sector = (Math.PI*2)/n;
					const idx = Math.max(0, Math.min(n-1, Math.floor(a/sector)));
					const current = segments[idx] || `${idx+1}ë²ˆ`;
					const next = prompt('ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”', current);
					if (next === null) return;
					const name = (next || '').trim() || `${idx+1}ë²ˆ`;
					segments[idx] = name;
					const input = segWrap.querySelector(`input[data-index="${idx}"]`);
					if (input) input.value = name;
					drawWheel();
				});
				// ì»¨í˜í‹° ì´í™íŠ¸
				const confettiCanvas = document.getElementById('wheel-confetti');
				const cctx = confettiCanvas.getContext('2d');
				function triggerConfetti(){
					const W = confettiCanvas.width, H = confettiCanvas.height;
					const N = 120;
					const parts = Array.from({length: N}, ()=>({
						x: W/2,
						y: H/2,
						vx: (Math.random()*2-1)*220,
						vy: (Math.random()*2-1)*220 - 120,
						size: 3 + Math.random()*3,
						color: `hsl(${Math.floor(Math.random()*360)}, 80%, 60%)`,
						rot: Math.random()*Math.PI*2,
						vr: (Math.random()*2-1)*6
					}));
					let last = performance.now();
					const startTs = last;
					function step(now){
						const dt = Math.min(0.05, (now - last)/1000);
						last = now;
						cctx.clearRect(0,0,W,H);
						for (const p of parts){
							p.vy += 380*dt; // gravity
							p.x += p.vx*dt;
							p.y += p.vy*dt;
							p.rot += p.vr*dt;
							cctx.save();
							cctx.translate(p.x, p.y);
							cctx.rotate(p.rot);
							cctx.fillStyle = p.color;
							cctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6);
							cctx.restore();
						}
						if (now - startTs < 1500){
							requestAnimationFrame(step);
						} else {
							cctx.clearRect(0,0,W,H);
						}
					}
					requestAnimationFrame(step);
				}
			})();

			// ì‚¬ë‹¤ë¦¬ íƒ€ê¸° ë¡œì§
			(function initLadder(){
				const canvas = document.getElementById('ladder-canvas');
				if (!canvas) return;
				const ctx = canvas.getContext('2d');
				const countEl = document.getElementById('ladder-count');
				const namesWrap = document.getElementById('ladder-names');
				const footsWrap = document.getElementById('ladder-foots');
				const runBtn = document.getElementById('ladder-run');
				const resetBtn = document.getElementById('ladder-reset');
				const resultEl = document.getElementById('ladder-result');

				let columns = 5;
				let verticals = []; // x ì¢Œí‘œ
				let rungs = []; // ê°€ë¡œë°œ [{y, i}] iëŠ” ì™¼ìª½ ì„¸ë¡œì„  ì¸ë±ìŠ¤
				const padding = { left: 40, right: 40, top: 30, bottom: 30 };

				function buildInputs(n){
					namesWrap.innerHTML = '';
					footsWrap.innerHTML = '';
					for (let i=0;i<n;i++){
						const name = document.createElement('input');
						name.type = 'text';
						name.placeholder = `ì´ë¦„ ${i+1}`;
						namesWrap.appendChild(name);
						const foot = document.createElement('input');
						foot.type = 'text';
						foot.placeholder = `ê²°ê³¼ ${i+1}`;
						footsWrap.appendChild(foot);
					}
				}

				function generateLadder(n){
					columns = n;
					verticals = [];
					rungs = [];
					const w = canvas.width - padding.left - padding.right;
					const h = canvas.height - padding.top - padding.bottom;
					for (let i=0;i<n;i++){
						verticals.push(padding.left + (w * i)/(n-1));
					}
					// ëœë¤ ê°€ë¡œë°œ ìƒì„± (ì„¸ë¡œì„  ì‚¬ì´ì— ì¼ì • ìˆ˜)
					const rungPerGap = Math.max(1, Math.floor(h/80));
					for (let i=0;i<n-1;i++){
						const count = rungPerGap;
						for (let k=0;k<count;k++){
							const y = padding.top + Math.random()*h;
							rungs.push({ y, i });
						}
					}
					// y ê¸°ì¤€ ì •ë ¬ë¡œ êµì°¨ ìµœì†Œí™”
					rungs.sort((a,b)=>a.y-b.y);
				}

				function drawLadder(){
					ctx.clearRect(0,0,canvas.width,canvas.height);
					ctx.lineWidth = 3.5;
					ctx.strokeStyle = '#2a5573';
					// ì„¸ë¡œì„ 
					for (const x of verticals){
						ctx.beginPath();
						ctx.moveTo(x, padding.top);
						ctx.lineTo(x, canvas.height - padding.bottom);
						ctx.stroke();
					}
					// ê°€ë¡œë°œ
					ctx.lineWidth = 3;
					for (const r of rungs){
						const x1 = verticals[r.i];
						const x2 = verticals[r.i+1];
						ctx.beginPath();
						ctx.moveTo(x1, r.y);
						ctx.lineTo(x2, r.y);
						ctx.stroke();
					}
					// ë¼ë²¨ (ìƒë‹¨ ì´ë¦„, í•˜ë‹¨ ê²°ê³¼)
					const nameInputs = Array.from(namesWrap.querySelectorAll('input'));
					const footInputs = Array.from(footsWrap.querySelectorAll('input'));
					ctx.fillStyle = '#074b78';
					ctx.font = 'bold 12px "Noto Sans KR", Arial';
					ctx.textAlign = 'center';
					ctx.textBaseline = 'bottom';
					for (let i=0;i<verticals.length;i++){
						const x = verticals[i];
						const topLabel = (nameInputs[i]?.value || `ì´ë¦„ ${i+1}`);
						ctx.fillText(topLabel, x, padding.top - 8);
					}
					ctx.textBaseline = 'top';
					for (let i=0;i<verticals.length;i++){
						const x = verticals[i];
						const botLabel = (footInputs[i]?.value || `ê²°ê³¼ ${i+1}`);
						ctx.fillText(botLabel, x, canvas.height - padding.bottom + 8);
					}
				}

				function computePath(startIdx){
					const segments = [];
					let x = verticals[startIdx];
					let y = padding.top;
					for (const r of rungs){
						if (r.y <= y) continue;
						// ìˆ˜ì§ ì´ë™
						segments.push({ x1: x, y1: y, x2: x, y2: r.y });
						y = r.y;
						// ì¢Œìš° ê°€ë¡œ ì´ë™
						if (Math.abs(x - verticals[r.i]) < 1e-6){
							segments.push({ x1: x, y1: y, x2: verticals[r.i+1], y2: y });
							x = verticals[r.i+1];
						} else if (Math.abs(x - verticals[r.i+1]) < 1e-6){
							segments.push({ x1: x, y1: y, x2: verticals[r.i], y2: y });
							x = verticals[r.i];
						}
					}
					// ë°”ë‹¥ê¹Œì§€ ìˆ˜ì§ ì´ë™
					segments.push({ x1: x, y1: y, x2: x, y2: canvas.height - padding.bottom });
					return segments;
				}

				function animatePath(segments, onDone){
					const speed = 320; // px/s
					let segIdx = 0;
					let segT = 0;
					let last = performance.now();
					function step(now){
						const dt = Math.min(0.05, (now - last)/1000);
						last = now;
						// ì§„í–‰
						let cur = segments[segIdx];
						const dx = cur.x2 - cur.x1;
						const dy = cur.y2 - cur.y1;
						const len = Math.hypot(dx, dy) || 0.0001;
						segT += (speed * dt) / len;
						if (segT >= 1){
							segT = 0;
							segIdx++;
							if (segIdx >= segments.length){
								drawLadder();
								if (onDone) onDone();
								return;
							}
							cur = segments[segIdx];
						}
						// ë Œë”
						drawLadder();
						ctx.save();
						ctx.lineWidth = 4;
						ctx.strokeStyle = '#ff7043';
						ctx.beginPath();
						for (let i=0;i<segIdx;i++){
							ctx.moveTo(segments[i].x1, segments[i].y1);
							ctx.lineTo(segments[i].x2, segments[i].y2);
						}
						// í˜„ì¬ ì„¸ê·¸ë¨¼íŠ¸ ì§„í–‰ ì¤‘ì¸ ì„ 
						const cx = cur.x1 + (cur.x2 - cur.x1) * segT;
						const cy = cur.y1 + (cur.y2 - cur.y1) * segT;
						ctx.moveTo(cur.x1, cur.y1);
						ctx.lineTo(cx, cy);
						ctx.stroke();
						// ì´ë™ ì 
						ctx.fillStyle = '#ef5350';
						ctx.beginPath();
						ctx.arc(cx, cy, 5, 0, Math.PI*2);
						ctx.fill();
						ctx.restore();
						requestAnimationFrame(step);
					}
					requestAnimationFrame(step);
				}

				function setDisabled(dis){
					Array.from(namesWrap.querySelectorAll('input')).forEach(i=>i.disabled=dis);
					Array.from(footsWrap.querySelectorAll('input')).forEach(i=>i.disabled=dis);
					countEl.disabled = dis;
					runBtn.disabled = dis;
					resetBtn.disabled = dis;
				}

				function runOnce(){
					const nameInputs = Array.from(namesWrap.querySelectorAll('input'));
					const footInputs = Array.from(footsWrap.querySelectorAll('input'));
					const names = nameInputs.map((el,i)=> (el.value||`ì´ë¦„ ${i+1}`));
					const foots = footInputs.map((el,i)=> (el.value||`ê²°ê³¼ ${i+1}`));
					const hTop = padding.top;
					const hBot = canvas.height - padding.bottom;
					// ê° ì„¸ë¡œì„  ì‹œì‘ì—ì„œ ì¶”ì 
					const mapping = new Array(columns);
					for (let c=0;c<columns;c++){
						let x = verticals[c];
						let y = hTop;
						for (const r of rungs){
							if (r.y <= y) continue;
							// ë‹¤ìŒ ê°€ë¡œë°œê¹Œì§€ ìˆ˜ì§ ì´ë™
							y = r.y;
							// ê°€ë¡œë°œì„ ë§Œë‚˜ë©´ ì¢Œìš° ì´ë™
							if (Math.abs(x - verticals[r.i]) < 1e-6){
								x = verticals[r.i+1];
							} else if (Math.abs(x - verticals[r.i+1]) < 1e-6){
								x = verticals[r.i];
							}
						}
						// ë°”ë‹¥ê¹Œì§€ ë„ë‹¬
						mapping[c] = verticals.findIndex(v => Math.abs(v - x) < 1e-6);
					}
					// ê²°ê³¼ ë¬¸ìì—´ êµ¬ì„±
					const lines = mapping.map((toIdx, fromIdx)=> `${names[fromIdx]} â†’ ${foots[toIdx]}`);
					resultEl.textContent = lines.join('\n');
					// ê·¸ë¦¬ê¸° ìƒˆë¡œê³ ì¹¨
					drawLadder();
				}

				function runAnimated(){
					const nameInputs = Array.from(namesWrap.querySelectorAll('input'));
					const footInputs = Array.from(footsWrap.querySelectorAll('input'));
					const names = nameInputs.map((el,i)=> (el.value||`ì´ë¦„ ${i+1}`));
					const foots = footInputs.map((el,i)=> (el.value||`ê²°ê³¼ ${i+1}`));
					setDisabled(true);
					const paths = [];
					for (let i=0;i<columns;i++) paths.push(computePath(i));
					const mapping = new Array(columns);
					function destIndexForPath(path){
						const last = path[path.length-1];
						const destX = last.x2;
						return verticals.findIndex(v => Math.abs(v - destX) < 1e-6);
					}
					let cur = 0;
					function next(){
						if (cur >= columns){
							const lines = mapping.map((toIdx, fromIdx)=> `${names[fromIdx]} â†’ ${foots[toIdx]}`);
							resultEl.textContent = lines.join('\n');
							setDisabled(false);
							return;
						}
						animatePath(paths[cur], ()=>{
							mapping[cur] = destIndexForPath(paths[cur]);
							cur++;
							next();
						});
					}
					drawLadder();
					next();
				}

				// ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸
				function rebuild(){
					const n = Math.max(2, Math.min(15, parseInt(countEl.value,10)||2));
					buildInputs(n);
					generateLadder(n);
					drawLadder();
					// ê°œì¸ ì‹¤í–‰ ë²„íŠ¼ ìƒì„±
					const btnWrap = document.getElementById('ladder-person-buttons');
					if (btnWrap){
						btnWrap.innerHTML = '';
						for (let i=0;i<n;i++){
							const b = document.createElement('button');
							b.className = 'btn';
							b.textContent = `ì‹œì‘ ${i+1}`;
							b.addEventListener('click', ()=> runOneAnimated(i));
							btnWrap.appendChild(b);
						}
					}
				}

				rebuild();
				countEl.addEventListener('change', rebuild);
				runBtn.addEventListener('click', runAnimated);

				function runOneAnimated(idx){
					const nameInputs = Array.from(namesWrap.querySelectorAll('input'));
					const footInputs = Array.from(footsWrap.querySelectorAll('input'));
					const names = nameInputs.map((el,i)=> (el.value||`ì´ë¦„ ${i+1}`));
					const foots = footInputs.map((el,i)=> (el.value||`ê²°ê³¼ ${i+1}`));
					setDisabled(true);
					const path = computePath(idx);
					function destIndexForPath(path){
						const last = path[path.length-1];
						const destX = last.x2;
						return verticals.findIndex(v => Math.abs(v - destX) < 1e-6);
					}
					animatePath(path, ()=>{
						const toIdx = destIndexForPath(path);
						resultEl.textContent = `${names[idx]} â†’ ${foots[toIdx]}`;
						setDisabled(false);
					});
				}
				resetBtn.addEventListener('click', ()=>{
					resultEl.textContent = '';
					rebuild();
				});
			})();
	</script>
</body>
</html>





